<app-header (Input_Emit_Value)="onFilter_Search($event)" [b_Nao_Exibir_Voltar]="b_Nao_Exibir_Voltar"></app-header>

<div *ngIf="Input_Value == null, else listagem" class="container mb-10 mt-8 pb-10 lg:mt-10 mx-auto cards-itens">
    <div *ngFor="let categoria of obj_Array_Categoria | filter: Input_Value">
        <div class="card" [routerLink]="['/conteudo', categoria.id]" >
            <img class="icon-card pt-9" src="assets/icons/person-study.svg">
            <p>{{categoria.nome}}</p>
        </div> 
    </div>
</div>

<ng-template #listagem>
    <div>
        <div class="container-list lg:bg-white lg:bg-opacity-60 relative px-2 top-6 md:top-9 lg:top-14 pb-12">
            <div class="grid grid-cols-2">
                <div class="flex relative left-2 lg:left-2 lg:ml-2.5">
                    <uni-title [ds_Titulo]="ds_Titulo"></uni-title>
                </div>
            </div>
            
            <div *ngIf="obj_Array_Conteudos?.length != 0">
                <div class="hidden div-grid-title mt-8 lg:grid grid-cols-6">
                    <p class="lg:text-center ml-4 font-semibold">ID</p>
                    <p class="font-semibold lg:grid">Título</p>
                    <p class="font-semibold lg:grid">Descrição</p>
                    <p class="lg:text-center font-semibold">Categoria</p>
                    <p class="lg:text-center font-semibold">Acessar</p>
                </div>
            </div>
            <div class="top-5 relative flex flex-col">
        
                <cdk-virtual-scroll-viewport class="cdk-listagem-items overflow-auto lg:hidden rounded-lg mb-2 shadow-xl"
                    [itemSize]="40" minBufferPx="600" maxBufferPx="600">
                    <div class="bg-white bg-opacity-60 my-1"
                        *cdkVirtualFor="let conteudo of obj_Array_Conteudos | filter: Input_Value" (click)="Focus_Item(target)">
        
                        <div #target class="div-grid-name-arrow grid grid-cols-2 xl:grid-cols-1" (click)="Show_Item(conteudo)">
                            <p class="my-3 lg:my-auto ml-5 w-10/12 truncate font-medium">
                                {{conteudo.nm_titulo}}</p>
                            <img class="my-auto xl:hidden {{conteudo.show? 'img-rotation-arrow-down':''}}"
                                src="assets/icons/arrow-up.svg">
                        </div>
                        <div class="pb-4 flex flex-col gap-y-1" *ngIf="conteudo.show">
        
                            <div class="flex flex-row gap-x-3">
                                <p class="ml-5 font-semibold">ID:</p>
                                <p class="my-auto w-4/12 truncate">{{conteudo.cd_conteudo}}</p>
                            </div>
                            <div class="flex flex-row gap-x-3">
                                <p class="ml-5 font-semibold">Usuário:</p>
                                <p class="my-auto">{{conteudo.ds_conteudo}}
                                </p>
                            </div>
                            <div class="flex flex-row gap-x-3">
                                <p class="ml-5 font-semibold">Link:</p>
                                <p class=" my-auto w-5/12 truncate">{{conteudo.ds_link}}
                                </p>
                            </div>
                            <div class="flex flex-row gap-x-3">
                                <p class="ml-5 font-semibold">Contegoria:</p>
                                <p class="my-auto w-4/12 truncate">
                                    {{conteudo.categoria.nm_categoria}}</p>
                            </div>
                            <div class="flex flex-row gap-x-3 behavior-button" (click)="OnClick_Access(conteudo)">
        
                                <p class="ml-5 text-center font-semibold text-unimed-green">Acessar</p>
                            </div>
                        </div>
                    </div>
                </cdk-virtual-scroll-viewport>
                
                <div class="hidden lg:grid" *ngFor="let conteudo of obj_Array_Conteudos | filter: Input_Value">
                    <div
                        class="rounded-lg div-grid-title border-l-8 border-l-unimed-green shadow-xl mb-2 lg:h-14 w-full lg:grid lg:grid-cols-6 bg-white hover:bg-slate-100">
                        <p class="text-center my-auto text-ellipsis overflow-hidden whitespace-nowrap font-normal text-base">
                            {{conteudo.cd_conteudo}}</p>
                        <p class="my-3 lg:my-auto text-ellipsis overflow-hidden whitespace-nowrap font-normal text-base">
                            {{conteudo.nm_titulo}}</p>
                        <p
                            class="my-auto mx-auto text-ellipsis overflow-hidden w-full whitespace-nowrap font-normal text-base">
                            {{conteudo.ds_conteudo}}</p>
                        <p class="text-center my-auto text-ellipsis overflow-hidden whitespace-nowrap font-normal text-base">
                            {{conteudo.categoria.nm_categoria}}</p>
                        <p (click)="OnClick_Access(conteudo)" class="text-center my-auto cursor-pointer text-unimed-green pointer font-semibold text-ellipsis overflow-hidden whitespace-nowrap text-base">
                            Acessar</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hidden lg:flex" *ngIf="obj_Array_Conteudos?.length != 0">
            <div class="relative" style="width: 502px; margin: 10px auto 0; justify-content: center; display: flex; top: 50px;">
                <uni-paginator (onPageChange)="Mudar_Pagina($event)" [nr_Pagina]="objConteudo.nr_pagina"
                    [nr_Por_Pagina]="objConteudo.page_lenght" [nr_Registros]="objConteudo.nr_registos">
                </uni-paginator>
            </div>
        </div>
        
        <app-modal (b_Click_Sobreposicao)="Close_Modal()" class="{{b_Show_Filter?'':'hidden'}}">
            <div class="grid grid-cols-2">
                <div class="flex flex-col relative left-2 lg:left-2 pb-4 lg:ml-2.5 -mt-4">
                    <uni-title ds_Titulo="Filtro"></uni-title>
                </div>
                <img class="behavior-button w-5 h-4 mt-1 absolute right-5 lg:right-8 top-8 cursor-pointer"
                    src="assets/icons/X.svg" (click)="Close_Modal()">
            </div>
            <div class="flex flex-col gap-y-2">
                <form>
                    <app-input [required]="true" label="Título" [(ngModel)]="objConteudo.nm_titulo" id="nm_titulo"
                        name="nm_titulo">
                    </app-input>
                    <app-input [required]="true" label="Descrição" [(ngModel)]="objConteudo.ds_conteudo" id="ds_conteudo"
                        name="ds_conteudo"></app-input>
                </form>
            </div>
            <div class="flex flex-row mt-4 gap-x-4 mx-4">
                <uni-button buttonClass="btn-outline" (click)="Close_Modal()">Voltar</uni-button>
                <uni-button buttonClass="btn-primary" (click)="Filtrar()">Filtrar</uni-button>
            </div>
        </app-modal>
        
        <div *ngIf="!obj_Array_Conteudos || obj_Array_Conteudos?.length == 0">
            <animation-nothing-found></animation-nothing-found>
        </div>
    </div>
</ng-template>